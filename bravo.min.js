"use strict";var BRAVO=BRAVO||{};BRAVO.Core=function(){var s=function(){var n={"SP.ContentType":{post:["deleteObject"],custom:[{name:"addFieldLink","function":function(n){this.executePost("fieldlinks",null,n,!0,"SP.FieldLink")}},{name:"getFieldByInternalName","function":function(n){return n=encodeURIComponent(n),this.executeGet("fields?$filter=InternalName eq '"+n+"'")}},{name:"getFieldByStaticName","function":function(n){return n=encodeURIComponent(n),this.executeGet("fields?$filter=StaticName eq '"+n+"'")}},{name:"getFieldByTitle","function":function(n){return n=encodeURIComponent(n),this.executeGet("fields?$filter=Title eq '"+n+"'")}},{name:"getFieldLinkByName","function":function(n){return n=encodeURIComponent(n),this.executeGet("fieldlinks?$filter=Name eq '"+n+"'")}},{name:"update","function":function(n){return this.executePost(null,null,n,!0,"SP.ContentType","MERGE")}}]},"SP.Field":{post:["deleteObject","setShowInDisplayForm","setShowInEditForm","setShowInNewForm"],custom:[{name:"update","function":function(n){return this.executePost(null,null,n,!0,"SP.Field","MERGE")}}]},"SP.FieldLink":{},"SP.File":{get:["getLimitedWebPartManager"],getBuffer:["openBinaryStream"],post:["approve","cancelUpload","checkIn","checkOut","copyTo","deleteObject","deny","moveTo","publish","recycle","undoCheckOut","unpublish"],postDataInBody:["continueUpload","finishUpload","saveBinaryStream","startUpload"],custom:[{name:"update","function":function(n){return this.executePost(null,null,n,!0,"SP.File","MERGE")}}]},"SP.FileVersion":{post:["deleteObject"]},"SP.Folder":{post:["deleteObject","recycle","uniqueContentTypeOrder"],custom:[{name:"addFile","function":function(n,t){return this.executePost("files/add",n,t,!0)}},{name:"addSubFolder","function":function(n){return this.executePost("folders/add",n)}},{name:"getFile","function":function(n){return this.executeGet("files?$filter=Name eq '"+n+"'")}},{name:"getSubFolder","function":function(n){return this.executeGet("folders?$filter=Name eq '"+n+"'")}},{name:"update","function":function(n){return this.executePost(null,null,n,!0,"SP.Folder","MERGE")}}]},"SP.Group":{custom:[{name:"containsUser","function":function(n){return this.executeGet("users?$filter=Id eq "+n.Id).exists}}]},"SP.List":{get:["getRelatedFields","getView"],getDataAsParameter:["getUserEffectivePermissions"],post:["addItem","breakRoleInheritance","deleteObject","recycle","renderListData","renderListFormData","reserveListItemId","resetRoleInheritance"],postDataInBodyNoArgs:["getChanges","getItems","getListItemChangesSinceToken"],custom:[{name:"addContentType","function":function(n){return this.executePost("contenttypes",null,n,!0,"SP.ContentType")}},{name:"addExistingContentType","function":function(n){return this.executePost("contenttypes/addAvailableContentType",n)}},{name:"addField","function":function(n){return this.executePost("fields/add",null,n,!0,"SP.Field")}},{name:"addFieldAsXml","function":function(n){return this.executePost("fields/createFieldAsXml",null,{parameters:{__metadata:{type:"SP.XmlSchemaFieldCreationInformation"},Options:SP.AddFieldOptions.addFieldInternalNameHint,SchemaXml:n}},!0)}},{name:"addItem","function":function(n){return this.executePost("items",null,n,!0,"SP.ListItem")}},{name:"addSiteGroup","function":function(n){return this.executePost("roleassignments/addroleassignment",n)}},{name:"addSubFolder","function":function(n){return this.get_RootFolder().addSubFolder(n)}},{name:"addView","function":function(n){return this.executePost("views",null,n,!0,"SP.View")}},{name:"getContentType","function":function(n){return n=encodeURIComponent(n),this.executeGet("contenttypes?$filter=Name eq '"+n+"'")}},{name:"getContentTypeById","function":function(n){return this.executeGet("contenttypes/getById",n)}},{name:"getDefaultDisplayFormUrl","function":function(){return this.executeGet("forms?$filter=FormType eq 4").ServerRelativeUrl}},{name:"getDefaultEditFormUrl","function":function(){return this.executeGet("forms?$filter=FormType eq 6").ServerRelativeUrl}},{name:"getDefaultNewFormUrl","function":function(){return this.executeGet("forms?$filter=FormType eq 8").ServerRelativeUrl}},{name:"getDefaultViewUrl","function":function(){return this.get_DefaultView().ServerRelativeUrl}},{name:"getField","function":function(n){return n=encodeURIComponent(n),this.executeGet("fields?$filter=Title eq '"+n+"' or InternalName eq '"+n+"' or StaticName eq '"+n+"'")}},{name:"getFieldById","function":function(n){return this.executeGet("fields/getById",n)}},{name:"getFieldByInternalName","function":function(n){return n=encodeURIComponent(n),this.executeGet("fields?$filter=InternalName eq '"+n+"'")}},{name:"getFieldByStaticName","function":function(n){return n=encodeURIComponent(n),this.executeGet("fields?$filter=StaticName eq '"+n+"'")}},{name:"getFieldByTitle","function":function(n){return n=encodeURIComponent(n),this.executeGet("fields?$filter=Title eq '"+n+"'")}},{name:"getItemById","function":function(n){return this.executeGet("items("+n+")")}},{name:"getItemByTitle","function":function(n){return n=encodeURIComponent(n),this.getItemsByFilter("Title eq '"+n+"'")}},{name:"getItemsByFilter","function":function(n){return this.executeGet("items?$filter="+n)}},{name:"getSchemaXml","function":function(){return this.executeGet("schemaxml")}},{name:"getSubFolder","function":function(n){return n=encodeURIComponent(n),this.executeGet("rootfolder/folders?$filter=Name eq '"+n+"'")}},{name:"getViewById","function":function(n){return this.executeGet("views/getById",n)}},{name:"getViewByTitle","function":function(n){return n=encodeURIComponent(n),this.executeGet("views?$filter=Title eq '"+n+"'")}},{name:"hasAccess","function":function(n,t){return f(this,t,n)}},{name:"update","function":function(n){return this.executePost(null,null,n,!0,"SP.List","MERGE")}}]},"SP.ListItem":{getDataAsParameter:["getUserEffectivePermissions"],post:["breakRoleInheritance","deleteObject","recycle","resetRoleInheritance"],postDataInBodyNoArgs:["validateUpdateListItem"],custom:[{name:"update","function":function(n){return this.executePost(null,null,n,!0,this.__metadata.type,"MERGE")}}]},"SP.RoleAssignment":{post:["deleteObject"]},"SP.RoleDefinition":{post:["deleteObject"]},"SP.Site":{post:["createPreviewSPSite","extendUpgradeReminderDate","getCatalog","getCustomListTemplates","getWebTemplates","invalidate","needsUpgradeByType","openWeb","openWebById","runHealthCheck","runUpgradeSiteSession","updateClientObjectModelUseRemoteAPIsPermissionSetting"],postDataInBodyNoArgs:["getChanges"],custom:[{name:"addCustomAction","function":function(n){return this.executePost("usercustomactions",null,n,!0,"SP.UserCustomAction")}},{name:"getCustomAction","function":function(n){return n=encodeURIComponent(n),this.executeGet("usercustomactions?$filter=Name eq '"+n+"' or Title eq '"+n+"'")}},{name:"getRootWeb","function":function(){return this._rootWeb=this._rootWeb||new BRAVO.Core.Web(this.ServerRelativeUrl),this._rootWeb}},{name:"hasAccess","function":function(n){return f(this,n)}},{name:"sendEmail","function":function(n){return n={properties:n},n.properties.__metadata={type:"SP.Utilities.EmailProperties"},this.executePost("_api/SP.Utilities.Utility.SendEmail",null,n,!0)}},{name:"update","function":function(n){return this.executePost(null,null,n,!0,"SP.Site","MERGE")}}]},"SP.UserCustomAction":{post:["deleteObject"]},"SP.View":{get:["renderAsHtml"],post:["deleteObject"],custom:[{name:"update","function":function(n){return this.executePost(null,null,n,!0,"SP.View","MERGE")}}]},"SP.ViewFieldCollection":{post:["addViewField","moveViewFieldTo","removeAllViewFields","removeViewField"]},"SP.Web":{get:["doesPushNotificationSubscriberExist","getAppInstanceById","getAppInstancesByProductId","getAvailableWebTemplates","getCatalog","getContextWebInformation","getCustomListTemplates","getDocumentLibraries","getFileByServerRelativeUrl","getFolderByServerRelativeUrl","getList","getPushNotificationSubscriber","getPushNotificationSubscribersByArgs","getPushNotificationSubscribersByUser","getSubwebsFilteredForCurrentUser","getUserById","getWebUrlFromPageUrl","mapsToIcon"],getDataAsParameter:["doesUserHavePermissions","getUserEffectivePermissions"],post:["applyTheme","applyWebTemplate","breakRoleInheritance","deleteObject","getAppBdcCatalog","getAppBdcCatalogForAppInstance","getEntity","registerPushNotificationSubscriber","resetRoleInheritance","unregisterPushNotificationSubscriber"],postDataAsParameter:["addCustomAction","ensureUser"],postDataInBodyNoArgs:["executeRemoteLOB","getChanges","loadAndInstallApp","loadAndInstallAppInSpecifiedLocale","loadApp","processExternalNotification"],custom:[{name:"addContentType","function":function(n){return this.executePost("contenttypes",null,n,!0,"SP.ContentType")}},{name:"addCustomAction","function":function(n){return this.executePost("usercustomactions",null,n,!0,"SP.UserCustomAction")}},{name:"addExistingContentType","function":function(n){return this.executePost("contenttypes/addAvailableContentType",n)}},{name:"addField","function":function(n){return this.executePost("fields/add",null,n,!0,"SP.Field")}},{name:"addFieldAsXml","function":function(n){return this.executePost("fields/createFieldAsXml",null,{parameters:{__metadata:{type:"SP.XmlSchemaFieldCreationInformation"},Options:SP.AddFieldOptions.addFieldInternalNameHint,SchemaXml:n}},!0)}},{name:"addFile","function":function(n,t){return this.executePost("rootfolder/files/add",n,t,!0)}},{name:"addList","function":function(n){return this.executePost("lists",null,n,!0,"SP.List")}},{name:"addPermission","function":function(n){return n.__metadata={type:"SP.RoleDefinition"},this.executePost("roledefinitions",null,n,!0,"SP.RoleDefinition")}},{name:"addSiteGroup","function":function(n){return this.executePost("sitegroups",null,{Title:n},!0,"SP.Group")}},{name:"addSubFolder","function":function(n){return this.executePost("rootfolder/folders/add",n)}},{name:"addWeb","function":function(n){return this.get_Webs().add(n)}},{name:"getContentType","function":function(n){return n=encodeURIComponent(n),this.executeGet("contenttypes?$filter=Name eq '"+n+"'")}},{name:"getContentTypeById","function":function(n){return this.executeGet("contenttypes/getById",n)}},{name:"getCustomAction","function":function(n){return n=encodeURIComponent(n),this.executeGet("usercustomactions?$filter=Name eq '"+n+"' or Title eq '"+n+"'")}},{name:"getField","function":function(n){return n=encodeURIComponent(n),this.executeGet("fields?$filter=Title eq '"+n+"' or InternalName eq '"+n+"' or StaticName eq '"+n+"'")}},{name:"getFieldById","function":function(n){return this.executeGet("fields/getById",n)}},{name:"getFieldByInternalName","function":function(n){return n=encodeURIComponent(n),this.executeGet("fields?$filter=InternalName eq '"+n+"'")}},{name:"getFieldByStaticName","function":function(n){return n=encodeURIComponent(n),this.executeGet("fields?$filter=StaticName eq '"+n+"'")}},{name:"getFieldByTitle","function":function(n){return n=encodeURIComponent(n),this.executeGet("fields?$filter=Title eq '"+n+"'")}},{name:"getFile","function":function(n){return n=encodeURIComponent(n),this.executeGet("rootfolder/files?$filter=Name eq '"+n+"'")}},{name:"getListById","function":function(n){return this.executeGet("lists/getById",n)}},{name:"getListByTitle","function":function(n){return n=encodeURIComponent(n),this.executeGet("lists?$filter=Title eq '"+n+"'")}},{name:"getSiteGroupById","function":function(n){return this.executeGet("sitegroups/getById",n)}},{name:"getSiteGroupByName","function":function(n){return this.executeGet("sitegroups/getByName",n)}},{name:"getSubFolder","function":function(n){return n=encodeURIComponent(n),this.executeGet("rootfolder/folders?$filter=Name eq '"+n+"'")}},{name:"getUserById","function":function(n){return this.executeGet("siteusers?$filter=Id eq "+n)}},{name:"getUserByLogin","function":function(n){return this.executeGet("siteusers/getByLoginName",null,n)}},{name:"hasAccess","function":function(n){return f(this,n)}},{name:"sendEmail","function":function(n){return n={properties:n},n.properties.__metadata={type:"SP.Utilities.EmailProperties"},this.executePost("_api/SP.Utilities.Utility.SendEmail",null,n,!0)}},{name:"update","function":function(n){return this.executePost(null,null,n,!0,"SP.Web","MERGE")}}]},"SP.WebParts.LimitedWebPartManager":{custom:[{name:"get_WebParts","function":function(){return new BRAVO.Core.Object(this.TargetUrl,this.TargetEndPoint+"/WebParts?$expand=WebPart",this.asyncFl)}}]},contenttypes:{get:["getById"],post:["addAvailableContentType"],postDataInBodyNoArgs:["add"]},fields:{get:["getById","getByInternalNameOrTitle"],post:["addDependentLookup"],postDataInBodyNoArgs:["addField","createFieldAsXml"]},fieldlinks:{get:["getById"],postDataInBodyNoArgs:["add"]},files:{get:["getByTitle","getByUrl"],postDataInBody:["add","addTemplateFile"]},versions:{get:["getById"],post:["deleteAll","deleteById","deleteByLabel","restoreByLabel"]},folders:{get:["getByUrl"],post:["add"]},sitegroups:{get:["getById","getByName"],post:["removeById","removeByLoginName"]},items:{get:["getById"]},lists:{get:["getById"],post:["ensureSiteAssetsLibrary","ensureSitePagesLibrary"]},roleassignments:{get:["getByPrincipalId"],post:["addRoleAssignment","removeRoleAssignment"]},roledefinitions:{get:["getById","getByName","getByType"]},users:{get:["getByEmail","getById"],getDataAsParameter:["getByLoginName"],post:["removeById"],postDataAsParameter:["removeByLoginName"]},usercustomactions:{get:["getById"],post:["clear"]},views:{get:["getById"]},webs:{custom:[{name:"add","function":function(n){return n={parameters:n},n.parameters.__metadata={type:"SP.WebCreationInformation"},this.executePost("add",null,n,!0)}},]}};return n.siteusers=n.users,n},h=function(n){var r=null,h=s(),i,u,f,o,t;n.type=n.__metadata?n.__metadata.type:null;n.executeGet=c;n.executePost=l;n.refresh=y;n.setProperty=p;n.__metadata?(i=n.__metadata.type,/^SP\.Field/.test(i)&&(i="SP.Field"),/^SP\.Data\./.test(i)&&/Item$/.test(i)&&(i="SP.ListItem"),r=h[i]):(u=n.TargetEndPoint.split("/"),u=u[u.length-1].toLowerCase(),r=h[u]);for(f in r)for(o=0;o<r[f].length;o++){t=r[f][o];switch(f){case"custom":n[t.name]=t.function;break;case"get":n[t]=new Function("args","return this.executeGet('"+t+"', args);");break;case"getBuffer":n[t]=new Function("args","return this.executeGet('"+t+"', args, null, false, true);");break;case"getDataAsParameter":n[t]=new Function("data","return this.executeGet('"+t+"', null, data);");break;case"getDataInBody":n[t]=new Function("args","data","return this.executeGet('"+t+"', args, data, true);");break;case"getDataInBodyNoArgs":n[t]=new Function("data","return this.executeGet('"+t+"', null, data, true);");break;case"post":n[t]=new Function("args","data","type","return this.executePost('"+t+"', args, data, false, type);");break;case"postDataAsParameter":n[t]=new Function("args","data","type","return this.executePost('"+t+"', args, data, false, type);");break;case"postDataInBody":n[t]=new Function("args","data","type","return this.executePost('"+t+"', args, data, true, type);");break;case"postDataInBodyNoArgs":n[t]=new Function("data","type","return this.executePost('"+t+"', null, data, true, type);")}}n.results&&(n.getById=function(n){return e(this,["Id"],n)},n.getByTitle=function(n){return e(this,["Title","Name","InternalName","StaticName"],n)})},c=function(n,t,r,u,f,e){return u?i(this,"GET",e,n,r,null,f):f?i(this,"GET",e,n,r,null,f):(n=o(n,t,r),new BRAVO.Core.Object(this.TargetUrl,this.TargetEndPoint+"/"+n,this.asyncFl))},i=function(t,i,r,u,f,e,o){var s="",h;return r&&(f.__metadata={type:r}),s=u&&u.indexOf("_api/")==0?u.substr(5):t.TargetEndPoint+(u?"/"+u:""),h=t.TargetTemplate.replace("{{EndPoint}}",s).replace("{{Url}}",t.TargetUrl),n(t,h,i,f,e,o)},l=function(n,t,r,f,e,s){var l=null,h=null,c;return(s=s?s:"POST",(s=="DELETE"||s=="MERGE")&&(l={"IF-MATCH":"*"}),n=o(n,t,f?null:r),h=i(this,s,e,n,r,l),h=h?JSON.parse(h):h,h.d&&h.d.__metadata)?(c=u(this,h.d.__metadata.uri),new BRAVO.Core.Object(c.url,c.endPoint,this.asyncFl,h.d)):h},n=function(n,t,i,r,u,f){var e,s,o;if(t){if(e=v(),i=i?i:"GET",e.open(i=="GET"?"GET":"POST",t,n.asyncFl||f?!0:!1),f)return o=new BRAVO.Core.Promise,e.responseType="arraybuffer",e.onreadystatechange=function(){e.readyState==4&&e.status=="200"&&o.resolve(n,e.response)},e.send(),o;if(e.setRequestHeader("Accept","application/json;odata=verbose"),e.setRequestHeader("Content-Type","application/json;odata=verbose"),e.setRequestHeader("X-HTTP-Method",i),e.setRequestHeader("X-RequestDigest",document.querySelector("#__REQUESTDIGEST").value),u)for(s in u)e.setRequestHeader(s,u[s]);return(r=r?r.byteLength?r:JSON.stringify(r):null,n.asyncFl)?(o=new BRAVO.Core.Promise,e.onreadystatechange=function(){e.readyState==4&&e.status=="200"&&o.resolve(n,e.response)},e.send(r),o):(e.send(r),e.response)}},r=function(){var n=document.location.href;return _spPageContextInfo&&_spPageContextInfo.isAppWeb&&(n=BRAVO.Core.getQueryStringValue("SPHostUrl")+""),n=n.split("/"),n&&n.length>=2&&(n=n[0]+"//"+n[2]),n},a=function(n){var t=document.location.href.split("?"),u,i,r;for(t=t.length>1?t[1]:t[0],u=t.split("&"),i=0;i<u.length;i++)if((r=u[i].split("="),r.length!=1)&&decodeURIComponent(r[0])==n)return decodeURIComponent(r[1]);return null},e=function(n,t,i){var u,f,e,r,o;if(n.results==null||n.results.length==0)return null;for(u=0;u<t.length;u++)if(f=t[u],n.results[0][f]!=null)for(e=0;e<n.results.length;e++)if(r=n.results[e],o=r[f],r.__metadata&&r.__metadata.type=="SP.WebParts.WebPartDefinition"&&(o=r.WebPart[f]),o==i)return r;return null},u=function(n,t){var i="",r=t.split("/_api/SP.AppContextSite(@target)/");return r.length==1&&(r=t.split("/_api/")),r.length==1?(i=r[0].split("/"),i=(n.TargetEndPoint?n.TargetEndPoint+"/":"")+i[i.length-1]):i=r[1],{endPoint:i,url:n.TargetUrl}},v=function(){if(typeof XMLHttpRequest=="undefined"){try{return new ActiveXObject("Msxml2.XMLHTTP.6.0")}catch(n){}try{return new ActiveXObject("Msxml2.XMLHTTP.3.0")}catch(n){}try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(n){}throw new Error("This browser does not support XMLHttpRequest.");}return new XMLHttpRequest},f=function(n,t,i){var u=!1,h=n.asyncFl,e,o,s,f;if(n.asyncFl=!1,n.__metadata.type=="SP.Site")e=null,e=_spPageContextInfo.isAppWeb?r()+n.get_RootWeb().ServerRelativeUrl:_spPageContextInfo.siteAbsoluteUrl,u=new BRAVO.Core.Web(e).hasAccess(t);else if(n.__metadata.type=="SP.Web"&&(i=i||n.get_CurrentUser().LoginName),o=n.getUserEffectivePermissions(i),o.exists)for(u=!0,s=new SP.BasePermissions,s.initPropertiesFromJson(o.GetUserEffectivePermissions),f=0;f<t.length;f++)u&=s.has(t[f]);return n.asyncFl=h,u?!0:!1},y=function(){var i={asyncFl:this.asyncFl,RequestUrl:this.RequestUrl,TargetEndPoint:this.TargetEndPoint,TargetTemplate:this.TargetTemplate,TargetUrl:this.TargetUrl},r;return i.asyncFl?(r=new BRAVO.Core.Promise,n(i,i.RequestUrl).done(function(n,i){n.Response=JSON.parse(i);t(n,n.Response.d);r.resolve(n)}),r):(i.Response=JSON.parse(n(i,i.RequestUrl)),t(i,i.Response.d),i)},p=function(n,t){if(t!==undefined&&(this[n]==null||this[n]!=t)){var r='{ "'+n+'": '+(typeof t=="string"?'"'+t+'"':t)+" }",u=i(this,"MERGE",this.__metadata.type,null,JSON.parse(r),{"IF-MATCH":"*"});return u==""?(this[n]=t,!0):!1}},o=function(n,t,i){var u,e,f,r;if(n){if(u=n.indexOf("?$filter")>0,t){e=typeof t;n+="(";switch(e){case"boolean":n+=t?"true":"false";break;case"string":n+="'"+(u?encodeURIComponent(t):t)+"'";break;case"object":for(f in t)r=t[f],r=typeof r=="string"?"'"+r+"'":r,n+=f+"="+(u?encodeURIComponent(r):r)+", ";break;default:n+=t}return(n.endsWith(", ")?n.substr(0,n.length-2):n)+")"}i&&(i=typeof i=="string"?"'"+encodeURIComponent(i)+"'":JSON.stringify(i),n+="(@v)?@v="+i)}return n},t=function(n,t){var s,i,f,r,e,o;if(n.exists=t&&t.error==null,t){s=!1;n.TargetEndPoint.indexOf("?$filter")&&t.results&&(n.exists=t.results.length>0,t.results.length==1&&(s=!0,t=t.results[0],r=t.__metadata.uri.split("/_api/"),n.TargetEndPoint=r[1],n.TargetTemplate=n.TargetTemplate.replace(/&@target/,"?@target")));for(i in t)if(t[i]&&t[i].__deferred&&t[i].__deferred.uri)r=u(n,t[i].__deferred.uri),n["get_"+i]=new Function('return new BRAVO.Core.Object("'+r.url+'", "'+r.endPoint+'", this.asyncFl);');else if(i=="results"&&t[i]&&t[i]instanceof Array)for(n[i]=[],f=0;f<t[i].length;f++){if(r=u(n,t[i][f].__metadata.uri),e=new BRAVO.Core.Object(r.url,r.endPoint),e.Response.error==null)for(o in t[i][f])e[o]==null&&(e[o]=t[i][f][o]);n[i].push(e.Response.error?t[i][f]:e)}else n[i]=t[i];s&&(n.results=n.results?n.results:[n]);h(n)}};return{getQueryStringValue:a,Object:function(){var i=new function(){},r;if(arguments.length>1&&(i.TargetEndPoint=arguments[1],i.TargetUrl=arguments[0],i.TargetTemplate=(_spPageContextInfo.isAppWeb?_spPageContextInfo.webAbsoluteUrl:i.TargetUrl)+"/_api/"+(_spPageContextInfo.isAppWeb?"SP.AppContextSite(@target)/":"")+"{{EndPoint}}"+(_spPageContextInfo.isAppWeb?(i.TargetEndPoint.indexOf("?")>0?"&":"?")+"@target='{{Url}}'":""),i.RequestUrl=i.TargetTemplate.replace("{{EndPoint}}",i.TargetEndPoint).replace("{{Url}}",i.TargetUrl)),i.RequestUrl)if(arguments.length==4)t(i,arguments[3]);else{if(i.asyncFl=arguments[2]&&typeof arguments[2]=="boolean"?arguments[2]:!1,i.asyncFl)return r=new BRAVO.Core.Promise,n(i,i.RequestUrl).done(function(n,i){n.Response=JSON.parse(i);t(n,n.Response.d);r.resolve(n)}),r;i.Response=JSON.parse(n(i,i.RequestUrl));t(i,i.Response.d)}return i},Promise:function(){return{_arguments:null,_callback:null,_resolveFl:!1,done:function(n){this._callback=n;this._callback&&this._resolveFl&&this._callback.apply(this,this._arguments)},resolve:function(){this._arguments=arguments;this._resolveFl=!0;this._callback&&this._callback.apply(this,this._arguments)}}},Site:function(n,t){return n?new BRAVO.Core.Object(n.indexOf("http")==0?n:r()+n,"site",t):window._spPageContextInfo?new BRAVO.Core.Object(window._spPageContextInfo.siteAbsoluteUrl,"site",t):null},SiteAsync:function(n){return new BRAVO.Core.Site(n,!0)},Web:function(n,t){return n?new BRAVO.Core.Object(n.indexOf("http")==0?n:r()+n,"web",t):window._spPageContextInfo?new BRAVO.Core.Object(window._spPageContextInfo.webAbsoluteUrl,"web",t):null},WebAsync:function(n){return new BRAVO.Core.Web(n,!0)}}}();SP.SOD.notifyScriptLoadedAndExecuteWaitingJobs("bravo.js");BRAVO.JSLink=function(){function e(){if(r!=null)return r;var n=f();return n.exists&&(r=n.get_CurrentUser()),r}var s=null,y=function(n){return s!=null?s:n&&n.CurrentFieldSchema?n.CurrentFieldSchema:null},t=null,p=function(n){var i,r;return t!=null?t:(i=n.FormContext?n.FormContext.itemAttributes.Id:BRAVO.Core.getQueryStringValue("ID"),i&&(r=h(n),r.exists&&(t=r.getItemById(i))),t)},i=null,h=function(n){var t,r,u;return i!=null?i:(t=f(),t.exists&&(r=n&&n.FormContext?n.FormContext.listAttributes.Id:null,u=n&&n.ListTitle?n.ListTitle:n.ListName,i=r?t.getListById(r):t.getListByTitle(u)),i)},r=null,u=null,f=function(){return u!=null?u:u=new BRAVO.Core.Web},o={Attachments:{View:window.RenderFieldValueDefault,DisplayForm:window.SPFieldAttachments_Default,EditForm:window.SPFieldAttachments_Default,NewForm:window.SPFieldAttachments_Default},Boolean:{View:window.RenderFieldValueDefault,DisplayForm:window.SPField_FormDisplay_DefaultNoEncode,EditForm:window.SPFieldBoolean_Edit,NewForm:window.SPFieldBoolean_Edit},Currency:{View:window.RenderFieldValueDefault,DisplayForm:window.SPField_FormDisplay_Default,EditForm:window.SPFieldNumber_Edit,NewForm:window.SPFieldNumber_Edit},Calculated:{View:window.RenderFieldValueDefault,DisplayForm:window.SPField_FormDisplay_Default,EditForm:window.SPField_FormDisplay_Empty,NewForm:window.SPField_FormDisplay_Empty},Choice:{View:window.RenderFieldValueDefault,DisplayForm:window.SPField_FormDisplay_Default,EditForm:window.SPFieldChoice_Edit,NewForm:window.SPFieldChoice_Edit},Computed:{View:window.RenderFieldValueDefault,DisplayForm:window.SPField_FormDisplay_Default,EditForm:window.SPField_FormDisplay_Default,NewForm:window.SPField_FormDisplay_Default},DateTime:{View:window.RenderFieldValueDefault,DisplayForm:window.SPFieldDateTime_Display,EditForm:window.SPFieldDateTime_Edit,NewForm:window.SPFieldDateTime_Edit},File:{View:window.RenderFieldValueDefault,DisplayForm:window.SPFieldFile_Display,EditForm:window.SPFieldFile_Edit,NewForm:window.SPFieldFile_Edit},Integer:{View:window.RenderFieldValueDefault,DisplayForm:window.SPField_FormDisplay_Default,EditForm:window.SPFieldNumber_Edit,NewForm:window.SPFieldNumber_Edit},Lookup:{View:window.RenderFieldValueDefault,DisplayForm:window.SPFieldLookup_Display,EditForm:window.SPFieldLookup_Edit,NewForm:window.SPFieldLookup_Edit},LookupMulti:{View:window.RenderFieldValueDefault,DisplayForm:window.SPFieldLookup_Display,EditForm:window.SPFieldLookup_Edit,NewForm:window.SPFieldLookup_Edit},MultiChoice:{View:window.RenderFieldValueDefault,DisplayForm:window.SPField_FormDisplay_Default,EditForm:window.SPFieldMultiChoice_Edit,NewForm:window.SPFieldMultiChoice_Edit},Note:{View:window.RenderFieldValueDefault,DisplayForm:window.SPFieldNote_Display,EditForm:window.SPFieldNote_Edit,NewForm:window.SPFieldNote_Edit},Number:{View:window.RenderFieldValueDefault,DisplayForm:window.SPField_FormDisplay_Default,EditForm:window.SPFieldNumber_Edit,NewForm:window.SPFieldNumber_Edit},Text:{View:window.RenderFieldValueDefault,DisplayForm:window.SPField_FormDisplay_Default,EditForm:window.SPFieldText_Edit,NewForm:window.SPFieldText_Edit},URL:{View:window.RenderFieldValueDefault,DisplayForm:window.SPFieldUrl_Display,EditForm:window.SPFieldUrl_Edit,NewForm:window.SPFieldUrl_Edit},User:{View:window.RenderFieldValueDefault,DisplayForm:window.SPFieldUser_Display,EditForm:window.SPClientPeoplePickerCSRTemplate,NewForm:window.SPClientPeoplePickerCSRTemplate},UserMulti:{View:window.RenderFieldValueDefault,DisplayForm:window.SPFieldUserMulti_Display,EditForm:window.SPClientPeoplePickerCSRTemplate,NewForm:window.SPClientPeoplePickerCSRTemplate}},w=function(t){var f=["input","select"],r=document.createElement("div"),i,u;for(r.innerHTML=n(t),i=0;i<f.length;i++)if(u=r.querySelector(f[i]),u){u.setAttribute("data-field-name",t.CurrentFieldSchema.Name);break}return r.innerHTML},b=function(n,t){var f,i,r,u;if(n!=null&&t!=null){if(f=SPClientTemplates.Utility.GetFormContextForCurrentField(n),i=new SPClientForms.ClientValidation.ValidatorSet,typeof t=="object"&&t.length)for(r=0;r<t.length;r++)i.RegisterValidator(new c(t[r]));else u=function(){},u.prototype.Validate=t,i.RegisterValidator(new u);f.registerClientValidator(n.CurrentFieldSchema.Name,i)}},k=function(t){var i=e();return i.exists?a(t,i):n(t)},d=function(t,i){var u,f,r;if(t.CurrentFieldValue){u="";switch(t.CurrentFieldSchema.Type){case"MultiChoice":f=new RegExp(SPClientTemplates.Utility.UserLookupDelimitString,"g");u=t.CurrentFieldValue.replace(f,"; ").replace(/^; /g,"").replace(/; $/g,"");break;case"Note":u="<div>"+t.CurrentFieldValue.replace(/\n/g,"<br />")+"<\/div>";break;case"User":case"UserMulti":for(r=0;r<t.CurrentFieldValue.length;r++)u+=t.CurrentFieldValue[r].EntityData.SPUserID+SPClientTemplates.Utility.UserLookupDelimitString+t.CurrentFieldValue[r].DisplayText+(r==t.CurrentFieldValue.length-1?"":SPClientTemplates.Utility.UserLookupDelimitString)}t.CurrentFieldValue=u}return n(t,i,"DisplayForm")},g=function(t,i){return t.inGridMode?(i.AllowGridEditing=!1,""):n(t,i)},c=function(n){c.prototype.Validate=n},n=function(n,t,i){var u=t?t.Type:n.CurrentFieldSchema?n.CurrentFieldSchema.Type:null,f,t,r;if(i=i?i:null,i==null)switch(n.ControlMode){case SPClientTemplates.ClientControlMode.DisplayForm:i="DisplayForm";break;case SPClientTemplates.ClientControlMode.EditForm:i="EditForm";break;case SPClientTemplates.ClientControlMode.NewForm:i="NewForm";break;case SPClientTemplates.ClientControlMode.View:i="View"}if(o[u]&&o[u][i]&&(f=o[u][i](n),f))return f;t=n.CurrentFieldSchema;r=null;switch(t.Type){case"AllDayEvent":r=new AllDayEventFieldRenderer(t.Name);break;case"Attachments":r=new AttachmentFieldRenderer(t.Name);break;case"BusinessData":r=new BusinessDataFieldRenderer(t.Name);break;case"Computed":r=new ComputedFieldRenderer(t.Name);break;case"CrossProjectLink":r=new ProjectLinkFieldRenderer(t.Name);break;case"Currency":r=new NumberFieldRenderer(t.Name);break;case"DateTime":r=new DateTimeFieldRenderer(t.Name);break;case"Lookup":r=new LookupFieldRenderer(t.Name);break;case"LookupMulti":r=new LookupFieldRenderer(t.Name);break;case"Note":r=new NoteFieldRenderer(t.Name);break;case"Number":r=new NumberFieldRenderer(t.Name);break;case"Recurrence":r=new RecurrenceFieldRenderer(t.Name);break;case"Text":r=new TextFieldRenderer(t.Name);break;case"URL":r=new UrlFieldRenderer(t.Name);break;case"User":r=new UserFieldRenderer(t.Name);break;case"UserMulti":r=new UserFieldRenderer(t.Name);break;case"WorkflowStatus":r=new RawFieldRenderer(t.Name)}return r?r.RenderField(n,t,n.CurrentItem,n.ListSchema):n.CurrentItem[t.Name]},l=function(t,i){t.CurrentFieldValue=[];for(var r=0;r<i.length;r++)t.CurrentFieldValue.push({Description:i[r].LoginName,DisplayText:i[r].Title,EntityGroupName:"",EntityType:"",HierarchyIdentifier:null,IsResolved:!0,Key:i[r].LoginName,MultipleMatches:[],ProviderDisplayName:"",ProviderName:""});return n(t)},a=function(n,t){return l(n,[t])},v=function(n){return document.querySelector("#WebPart"+(n.FormUniqueId||n.wpq)+" .ms-formtable")},nt=function(n){return n.ListData?n.ListData.Row:[]},tt=function(){return SP.ListOperation.Selection.getSelectedItems()},it=function(n){var t=v(n);return t&&t.getAttribute("data-hide-row-event")==null&&(window.addEventListener("load",function(){for(var n,i=document.querySelectorAll(".hide-row"),t=0;t<i.length;t++){for(n=i[t];n&&n.nodeName.toLowerCase()!="tr";)n=n.parentNode;n&&(n.style.display="none")}}),t.setAttribute("data-hide-row-event",!0)),"<div class='hide-row' />"},rt=function(){var n=document.forms[MSOWebPartPageFormName];return n&&(n.MSOLayout_InDesignMode&&n.MSOLayout_InDesignMode.value=="1"||n._wikiPageMode&&n._wikiPageMode.value=="Edit")?!0:!1},ut=function(n,t,i,r){var u=f();u&&(i=typeof i=="string"?[i]:i,u.sendEmail({To:{results:i},From:r?r:e().Email,Subject:n,Body:t}))};return{addFieldNameAttribute:w,addValidation:b,defaultToCurrentUser:k,disableEdit:d,disableQuickEdit:g,getCurrentField:y,getCurrentItem:p,getCurrentList:h,getCurrentUser:e,getCurrentWeb:f,getFieldDefaultHtml:n,getFieldMultiUserHtml:l,getFieldUserHtml:a,getListView:v,getViewListItems:nt,getViewSelectedItems:tt,hideField:it,inEditMode:rt,sendEmail:ut}}();SP.SOD.notifyScriptLoadedAndExecuteWaitingJobs("bravo.jslink.js");BRAVO.ModalDialog=function(){var t=function(n,t){n!=null&&typeof n=="number"?SP.UI.ModalDialog.commonModalDialogClose(n,t):SP.UI.ModalDialog.commonModalDialogClose(SP.UI.DialogResult.cancel,t)},i=function(){return window.frameElement?window.frameElement.dialogArgs:null},r=function(){return SP.UI.ModalDialog.get_childDialog()!=null},n=function(n,t,i,r,u){if(arguments.length!=0){var f={args:r?r:null,dialogReturnValueCallback:u?u:null,showMaximized:i?!0:!1,title:n};return typeof t=="string"?f.url=t:f.html=t,SP.UI.ModalDialog.showModalDialog(f)}},u=function(t,i,r,u,f){var e=document.createElement("div");e.innerHTML=i;n(t,e,r,u,f)},f=function(n,t){n==SP.UI.DialogResult.OK&&(t&&typeof t=="string"&&(t.toLowerCase().indexOf("http")==0||t.indexOf("/")==0)&&(document.location.href=t),document.location.reload())},e=function(n,t,i,r){arguments.length!=0&&(i&&r?SP.UI.ModalDialog.showWaitScreenWithNoClose(n,t,i,r):SP.UI.ModalDialog.showWaitScreenWithNoClose(n,t))},o=function(n,t){var i={title:null,message:null},f=document.querySelector(".ms-dlgContent"),r,u;return f&&(r=f.querySelector(".ms-core-pageTitle"),r&&(i.title=r.innerHTML,r.innerHTML=n!=null?n:i.title),u=f.querySelector(".ms-textXLarge"),u&&(i.message=u.innerHTML,u.innerHTML=t!=null?t:i.message),SP.UI.ModalDialog.get_childDialog().autoSize()),i};return{close:t,getArguments:i,isDialog:r,open:n,openHtml:u,refreshOnSuccess:f,showWaitScreen:e,updateWaitScreen:o}}();SP.SOD.loadMultiple(["strings.js","sp.ui.dialog.js"],function(){SP.SOD.notifyScriptLoadedAndExecuteWaitingJobs("bravo.modaldialog.js")});
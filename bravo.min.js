/* Bravo Core Library v1.6.3 | (c) Bravo Consulting Group, LLC (Bravo) | bravocg.com */
"use strict";var BRAVO=BRAVO||{};BRAVO.Core=function(){var f=null,h=function(){var n={"SP.ContentType":{post:["deleteObject"],custom:[{name:"addFieldLink","function":function(n){this.executePost("fieldlinks",null,n,!0,"SP.FieldLink")}},{name:"getFieldByInternalName","function":function(n){return n=encodeURIComponent(n),this.executeGet("fields?$filter=InternalName eq '"+n+"'")}},{name:"getFieldByStaticName","function":function(n){return n=encodeURIComponent(n),this.executeGet("fields?$filter=StaticName eq '"+n+"'")}},{name:"getFieldByTitle","function":function(n){return n=encodeURIComponent(n),this.executeGet("fields?$filter=Title eq '"+n+"'")}},{name:"getFieldLinkByName","function":function(n){return n=encodeURIComponent(n),this.executeGet("fieldlinks?$filter=Name eq '"+n+"'")}},{name:"update","function":function(n){return this.executePost(null,null,n,!0,"SP.ContentType","MERGE")}}]},"SP.Field":{post:["deleteObject","setShowInDisplayForm","setShowInEditForm","setShowInNewForm"],custom:[{name:"update","function":function(n){return this.executePost(null,null,n,!0,"SP.Field","MERGE")}}]},"SP.FieldLink":{},"SP.File":{get:["getLimitedWebPartManager"],getBuffer:["openBinaryStream"],post:["approve","cancelUpload","checkIn","checkOut","copyTo","deleteObject","deny","moveTo","publish","recycle","undoCheckOut","unpublish"],postDataInBody:["continueUpload","finishUpload","saveBinaryStream","startUpload"],custom:[{name:"update","function":function(n){return this.executePost(null,null,n,!0,"SP.File","MERGE")}}]},"SP.FileVersion":{post:["deleteObject"]},"SP.Folder":{post:["deleteObject","recycle","uniqueContentTypeOrder"],custom:[{name:"addFile","function":function(n,t){return this.executePost("files/add",n,t,!0)}},{name:"addSubFolder","function":function(n){return this.executePost("folders/add",n)}},{name:"getFile","function":function(n){return this.executeGet("files?$filter=Name eq '"+n+"'")}},{name:"getSubFolder","function":function(n){return this.executeGet("folders?$filter=Name eq '"+n+"'")}},{name:"update","function":function(n){return this.executePost(null,null,n,!0,"SP.Folder","MERGE")}}]},"SP.Group":{custom:[{name:"containsUser","function":function(n){return this.executeGet("users?$filter=Id eq "+n.Id).exists}}]},"SP.List":{get:["getRelatedFields","getView"],getDataAsParameter:["getUserEffectivePermissions"],post:["addItem","breakRoleInheritance","deleteObject","recycle","renderListData","renderListFormData","reserveListItemId","resetRoleInheritance"],postDataInBodyNoArgs:["getChanges","getItems","getListItemChangesSinceToken"],custom:[{name:"addContentType","function":function(n){return this.executePost("contenttypes",null,n,!0,"SP.ContentType")}},{name:"addExistingContentType","function":function(n){return this.executePost("contenttypes/addAvailableContentType",n)}},{name:"addField","function":function(n){return this.executePost("fields/add",null,n,!0,"SP.Field")}},{name:"addFieldAsXml","function":function(n){return this.executePost("fields/createFieldAsXml",null,{parameters:{__metadata:{type:"SP.XmlSchemaFieldCreationInformation"},Options:SP.AddFieldOptions.addFieldInternalNameHint,SchemaXml:n}},!0)}},{name:"addItem","function":function(n){return this.executePost("items",null,n,!0,"SP.ListItem")}},{name:"addSiteGroup","function":function(n){return this.executePost("roleassignments/addroleassignment",n)}},{name:"addSubFolder","function":function(n){return this.get_RootFolder().addSubFolder(n)}},{name:"addView","function":function(n){return this.executePost("views",null,n,!0,"SP.View")}},{name:"getContentType","function":function(n){return n=encodeURIComponent(n),this.executeGet("contenttypes?$filter=Name eq '"+n+"'")}},{name:"getContentTypeById","function":function(n){return this.executeGet("contenttypes/getById",n)}},{name:"getDefaultDisplayFormUrl","function":function(){return this.executeGet("forms?$filter=FormType eq 4").ServerRelativeUrl}},{name:"getDefaultEditFormUrl","function":function(){return this.executeGet("forms?$filter=FormType eq 6").ServerRelativeUrl}},{name:"getDefaultNewFormUrl","function":function(){return this.executeGet("forms?$filter=FormType eq 8").ServerRelativeUrl}},{name:"getDefaultViewUrl","function":function(){return this.get_DefaultView().ServerRelativeUrl}},{name:"getField","function":function(n){return n=encodeURIComponent(n),this.executeGet("fields?$filter=Title eq '"+n+"' or InternalName eq '"+n+"' or StaticName eq '"+n+"'")}},{name:"getFieldById","function":function(n){return this.executeGet("fields/getById",n)}},{name:"getFieldByInternalName","function":function(n){return n=encodeURIComponent(n),this.executeGet("fields?$filter=InternalName eq '"+n+"'")}},{name:"getFieldByStaticName","function":function(n){return n=encodeURIComponent(n),this.executeGet("fields?$filter=StaticName eq '"+n+"'")}},{name:"getFieldByTitle","function":function(n){return n=encodeURIComponent(n),this.executeGet("fields?$filter=Title eq '"+n+"'")}},{name:"getItemById","function":function(n){return this.executeGet("items("+n+")")}},{name:"getItemByTitle","function":function(n){return n=encodeURIComponent(n),this.getItemsByFilter("Title eq '"+n+"'")}},{name:"getItemsByFilter","function":function(n){return this.executeGet("items?$filter="+n)}},{name:"getSchemaXml","function":function(){return this.executeGet("schemaxml")}},{name:"getSubFolder","function":function(n){return n=encodeURIComponent(n),this.executeGet("rootfolder/folders?$filter=Name eq '"+n+"'")}},{name:"getViewById","function":function(n){return this.executeGet("views/getById",n)}},{name:"getViewByTitle","function":function(n){return n=encodeURIComponent(n),this.executeGet("views?$filter=Title eq '"+n+"'")}},{name:"hasAccess","function":function(n,t){return u(this,t,n)}},{name:"update","function":function(n){return this.executePost(null,null,n,!0,"SP.List","MERGE")}}]},"SP.ListItem":{getDataAsParameter:["getUserEffectivePermissions"],post:["breakRoleInheritance","deleteObject","recycle","resetRoleInheritance"],postDataInBodyNoArgs:["validateUpdateListItem"],custom:[{name:"update","function":function(n){return this.executePost(null,null,n,!0,this.__metadata.type,"MERGE")}}]},"SP.RoleAssignment":{post:["deleteObject"]},"SP.RoleDefinition":{post:["deleteObject"]},"Microsoft.Office.Server.Search.REST.SearchService":{custom:[{name:"query","function":function(n){return typeof n=="string"?this.executeGet("query?"+n):(n={request:n},n.request.__metadata={type:"Microsoft.Office.Server.Search.REST.SearchRequest"},this.executePost("postquery",null,n,!0))}},{name:"querySuggestion","function":function(n){return this.executeGet("suggest?"+n)}},]},"SP.Site":{post:["createPreviewSPSite","extendUpgradeReminderDate","getCatalog","getCustomListTemplates","getWebTemplates","invalidate","needsUpgradeByType","openWeb","openWebById","runHealthCheck","runUpgradeSiteSession","updateClientObjectModelUseRemoteAPIsPermissionSetting"],postDataInBodyNoArgs:["getChanges"],custom:[{name:"addCustomAction","function":function(n){return this.executePost("usercustomactions",null,n,!0,"SP.UserCustomAction")}},{name:"getCustomAction","function":function(n){return n=encodeURIComponent(n),this.executeGet("usercustomactions?$filter=Name eq '"+n+"' or Title eq '"+n+"'")}},{name:"getRootWeb","function":function(){return this._rootWeb=this._rootWeb||new BRAVO.Core.Web(this.ServerRelativeUrl,this.asyncFl),this._rootWeb}},{name:"hasAccess","function":function(n){return u(this,n)}},{name:"sendEmail","function":function(n){return n={properties:n},n.properties.__metadata={type:"SP.Utilities.EmailProperties"},this.executePost("_api/SP.Utilities.Utility.SendEmail",null,n,!0)}},{name:"update","function":function(n){return this.executePost(null,null,n,!0,"SP.Site","MERGE")}}]},"SP.Social.SocialRestActor":{custom:[{name:"createPost","function":function(n){return n={restCreationData:{__metadata:{type:"SP.Social.SocialRestPostCreationData"},ID:null,creationData:n}},n.restCreationData.creationData.__metadata={type:"SP.Social.SocialPostCreationData"},this.executePost("feed/post",null,n,!0)}},{name:"getFeed","function":function(){return this.executeGet("feed")}},]},"SP.Social.SocialRestFeedManager":{custom:[{name:"createPost","function":function(n){return n={restCreationData:{__metadata:{type:"SP.Social.SocialRestPostCreationData"},ID:null,creationData:n}},n.restCreationData.creationData.__metadata={type:"SP.Social.SocialPostCreationData"},this.executePost("my/feed/post",null,n,!0)}},{name:"deletePost","function":function(n){return this.executePost("post/delete",null,{ID:n},!0)}},{name:"getMyFeed","function":function(){return this.executeGet("my/feed")}},{name:"getMyInfo","function":function(){return this.executeGet("my")}},{name:"getMyLikes","function":function(){return this.executeGet("my/likes")}},{name:"getMyMentionFeed","function":function(){return this.executeGet("my/mentionfeed")}},{name:"getMyNews","function":function(){return this.executeGet("my/news")}},{name:"getMyTimeLineFeed","function":function(){return this.executeGet("my/timelinefeed")}},{name:"getMyUnreadMentionCount","function":function(){return this.executeGet("my/unreadmentioncount")}},{name:"getPost","function":function(n){return this.executePost("post",null,{ID:n},!0)}},{name:"getPostLikers","function":function(n){return this.executePost("post/likers",null,{ID:n},!0)}},{name:"getUser","function":function(n){return n.indexOf("i:0#.f|")==0?this.executeGet("actor",null,n):this.executeGet("actor",n)}},{name:"likePost","function":function(n){return this.executePost("post/like",null,{ID:n},!0)}},{name:"lockPost","function":function(n){return this.executePost("post/lock",null,{ID:n},!0)}},{name:"replyToPost","function":function(n,t){return t={restCreationData:{__metadata:{type:"SP.Social.SocialRestPostCreationData"},ID:n,creationData:t}},t.restCreationData.creationData.__metadata={type:"SP.Social.SocialPostCreationData"},this.executePost("post/reply",null,t,!0)}},{name:"unlikePost","function":function(n){return this.executePost("post/unlike",null,{ID:n},!0)}},{name:"unlockPost","function":function(n){return this.executePost("post/unlock",null,{ID:n},!0)}},]},"SP.Social.SocialRestThread":{custom:[{name:"delete","function":function(n){return this.executePost("delete",null,{ID:n||this.ID},!0)}},{name:"like","function":function(n){return this.executePost("like",null,{ID:n||this.ID},!0)}},{name:"lock","function":function(n){return this.executePost("lock",null,{ID:n||this.ID},!0)}},{name:"reply","function":function(n,t){return n={restCreationData:{__metadata:{type:"SP.Social.SocialRestPostCreationData"},ID:t||this.ID,creationData:n}},n.restCreationData.creationData.__metadata={type:"SP.Social.SocialPostCreationData"},this.executePost("reply",null,n,!0)}},{name:"unlike","function":function(n){return this.executePost("unlike",null,{ID:n||this.ID},!0)}},{name:"unlock","function":function(n){return this.executePost("unlock",null,{ID:n||this.ID},!0)}},]},"SP.UserCustomAction":{post:["deleteObject"]},"SP.UserProfiles.PeopleManager":{get:["amlFollowedBy","amlFollowing","getFollowedTags","getFollowersFor","getMyFollowers","getMyProperties","getMySuggestions","getPeopleFollowedBy","getPeopleFollowedByMe","getPropertiesFor","getUserProfilePropertyFor"],getAppendMethodToEndPoint:["getTrendingTags","isFollowing"],post:["follow","followTag","hideSuggestion","stopFollowing","stopFollowingTag"],postDataInBody:["setMyProfilePicture"]},"SP.UserProfiles.ProfileLoader":{post:["getOwnerUserProfile","getUserProfile"],postDataInBody:["createPersonalSiteEnqueueBulk"]},"SP.UserProfiles.UserProfile":{post:["createPersonalSiteEnque","shareAllSocialData"],custom:[{name:"getOneDriveUrl","function":function(){return this.FollowPersonalSiteUrl+"_layouts/15/onedrive.aspx"}}]},"SP.View":{get:["renderAsHtml"],post:["deleteObject"],custom:[{name:"update","function":function(n){return this.executePost(null,null,n,!0,"SP.View","MERGE")}}]},"SP.ViewFieldCollection":{post:["addViewField","moveViewFieldTo","removeAllViewFields","removeViewField"]},"SP.Web":{get:["doesPushNotificationSubscriberExist","getAppInstanceById","getAppInstancesByProductId","getAvailableWebTemplates","getCatalog","getContextWebInformation","getCustomListTemplates","getDocumentLibraries","getFileByServerRelativeUrl","getFolderByServerRelativeUrl","getList","getPushNotificationSubscriber","getPushNotificationSubscribersByArgs","getPushNotificationSubscribersByUser","getSubwebsFilteredForCurrentUser","getUserById","getWebUrlFromPageUrl","mapsToIcon"],getDataAsParameter:["doesUserHavePermissions","getUserEffectivePermissions"],post:["applyTheme","applyWebTemplate","breakRoleInheritance","deleteObject","getAppBdcCatalog","getAppBdcCatalogForAppInstance","getEntity","registerPushNotificationSubscriber","resetRoleInheritance","unregisterPushNotificationSubscriber"],postDataAsParameter:["addCustomAction","ensureUser"],postDataInBodyNoArgs:["executeRemoteLOB","getChanges","loadAndInstallApp","loadAndInstallAppInSpecifiedLocale","loadApp","processExternalNotification"],custom:[{name:"addContentType","function":function(n){return this.executePost("contenttypes",null,n,!0,"SP.ContentType")}},{name:"addCustomAction","function":function(n){return this.executePost("usercustomactions",null,n,!0,"SP.UserCustomAction")}},{name:"addExistingContentType","function":function(n){return this.executePost("contenttypes/addAvailableContentType",n)}},{name:"addField","function":function(n){return this.executePost("fields/add",null,n,!0,"SP.Field")}},{name:"addFieldAsXml","function":function(n){return this.executePost("fields/createFieldAsXml",null,{parameters:{__metadata:{type:"SP.XmlSchemaFieldCreationInformation"},Options:SP.AddFieldOptions.addFieldInternalNameHint,SchemaXml:n}},!0)}},{name:"addFile","function":function(n,t){return this.executePost("rootfolder/files/add",n,t,!0)}},{name:"addList","function":function(n){return this.executePost("lists",null,n,!0,"SP.List")}},{name:"addPermission","function":function(n){return n.__metadata={type:"SP.RoleDefinition"},this.executePost("roledefinitions",null,n,!0,"SP.RoleDefinition")}},{name:"addSiteGroup","function":function(n){return this.executePost("sitegroups",null,{Title:n},!0,"SP.Group")}},{name:"addSubFolder","function":function(n){return this.executePost("rootfolder/folders/add",n)}},{name:"addWeb","function":function(n){return this.get_Webs().add(n)}},{name:"getContentType","function":function(n){return n=encodeURIComponent(n),this.executeGet("contenttypes?$filter=Name eq '"+n+"'")}},{name:"getContentTypeById","function":function(n){return this.executeGet("contenttypes/getById",n)}},{name:"getCustomAction","function":function(n){return n=encodeURIComponent(n),this.executeGet("usercustomactions?$filter=Name eq '"+n+"' or Title eq '"+n+"'")}},{name:"getField","function":function(n){return n=encodeURIComponent(n),this.executeGet("fields?$filter=Title eq '"+n+"' or InternalName eq '"+n+"' or StaticName eq '"+n+"'")}},{name:"getFieldById","function":function(n){return this.executeGet("fields/getById",n)}},{name:"getFieldByInternalName","function":function(n){return n=encodeURIComponent(n),this.executeGet("fields?$filter=InternalName eq '"+n+"'")}},{name:"getFieldByStaticName","function":function(n){return n=encodeURIComponent(n),this.executeGet("fields?$filter=StaticName eq '"+n+"'")}},{name:"getFieldByTitle","function":function(n){return n=encodeURIComponent(n),this.executeGet("fields?$filter=Title eq '"+n+"'")}},{name:"getFile","function":function(n){return n=encodeURIComponent(n),this.executeGet("rootfolder/files?$filter=Name eq '"+n+"'")}},{name:"getListById","function":function(n){return this.executeGet("lists/getById",n)}},{name:"getListByTitle","function":function(n){return n=encodeURIComponent(n),this.executeGet("lists?$filter=Title eq '"+n+"'")}},{name:"getSiteGroupById","function":function(n){return this.executeGet("sitegroups/getById",n)}},{name:"getSiteGroupByName","function":function(n){return this.executeGet("sitegroups/getByName",n)}},{name:"getSubFolder","function":function(n){return n=encodeURIComponent(n),this.executeGet("rootfolder/folders?$filter=Name eq '"+n+"'")}},{name:"getUserById","function":function(n){return this.executeGet("siteusers?$filter=Id eq "+n)}},{name:"getUserByLogin","function":function(n){return this.executeGet("siteusers/getByLoginName",null,n)}},{name:"hasAccess","function":function(n){return u(this,n)}},{name:"sendEmail","function":function(n){return n={properties:n},n.properties.__metadata={type:"SP.Utilities.EmailProperties"},this.executePost("_api/SP.Utilities.Utility.SendEmail",null,n,!0)}},{name:"update","function":function(n){return this.executePost(null,null,n,!0,"SP.Web","MERGE")}}]},"SP.WebParts.LimitedWebPartManager":{custom:[{name:"get_WebParts","function":function(){return new BRAVO.Core.Object(this.TargetUrl,this.TargetEndPoint+"/WebParts?$expand=WebPart",this.asyncFl)}}]},contenttypes:{get:["getById"],post:["addAvailableContentType"],postDataInBodyNoArgs:["add"]},fields:{get:["getById","getByInternalNameOrTitle"],post:["addDependentLookup"],postDataInBodyNoArgs:["addField","createFieldAsXml"]},fieldlinks:{get:["getById"],postDataInBodyNoArgs:["add"]},files:{get:["getByTitle","getByUrl"],postDataInBody:["add","addTemplateFile"]},versions:{get:["getById"],post:["deleteAll","deleteById","deleteByLabel","restoreByLabel"]},folders:{get:["getByUrl"],post:["add"]},sitegroups:{get:["getById","getByName"],post:["removeById","removeByLoginName"]},items:{get:["getById"]},lists:{get:["getById"],post:["ensureSiteAssetsLibrary","ensureSitePagesLibrary"]},roleassignments:{get:["getByPrincipalId"],post:["addRoleAssignment","removeRoleAssignment"]},roledefinitions:{get:["getById","getByName","getByType"]},users:{get:["getByEmail","getById"],getDataAsParameter:["getByLoginName"],post:["removeById"],postDataAsParameter:["removeByLoginName"]},usercustomactions:{get:["getById"],post:["clear"]},views:{get:["getById"]},webs:{custom:[{name:"add","function":function(n){return n={parameters:n},n.parameters.__metadata={type:"SP.WebCreationInformation"},this.executePost("add",null,n,!0)}},]}};return n.siteusers=n.users,n},c=function(n){var f=null,c=h(),u,o,s,i,r;n.type=n.__metadata?n.__metadata.type:null;n.executeGet=l;n.executePost=a;n.refresh=w;n.setProperty=b;n.__metadata?(u=n.__metadata.type,/^SP\.Field/.test(u)&&(u="SP.Field"),/^SP\.Data\./.test(u)&&/Item$/.test(u)&&(u="SP.ListItem"),f=c[u]):(o=n.TargetEndPoint.split("/"),o=o[o.length-1].toLowerCase(),f=c[o]);for(s in f)for(r=0;r<f[s].length;r++){i=f[s][r];switch(s){case"custom":n[i.name]=i.function;break;case"get":n[i]=new Function("args","return this.executeGet('"+i+"', args);");break;case"getAppendMethodToEndPoint":n[i]=new Function("args","return this.executeGet(null, args, null, null, null, null, '"+i+"');");break;case"getBuffer":n[i]=new Function("args","return this.executeGet('"+i+"', args, null, false, true);");break;case"getDataAsParameter":n[i]=new Function("data","return this.executeGet('"+i+"', null, data);");break;case"getDataInBody":n[i]=new Function("args","data","return this.executeGet('"+i+"', args, data, true);");break;case"getDataInBodyNoArgs":n[i]=new Function("data","return this.executeGet('"+i+"', null, data, true);");break;case"post":n[i]=new Function("args","data","type","return this.executePost('"+i+"', args, data, false, type);");break;case"postAppendMethodToEndPoint":n[i]=new Function("args","data","type","return this.executePost(null, args, data, false, type, null, '"+i+"');");break;case"postDataAsParameter":n[i]=new Function("args","data","type","return this.executePost('"+i+"', args, data, false, type);");break;case"postDataInBody":n[i]=new Function("args","data","type","return this.executePost('"+i+"', args, data, true, type);");break;case"postDataInBodyNoArgs":n[i]=new Function("data","type","return this.executePost('"+i+"', null, data, true, type);")}}if(n.results)for(n.getById=function(n){return e(this,["Id"],n)},n.getByTitle=function(n){return e(this,["Title","Name","InternalName","StaticName"],n)},r=0;r<n.results.length;r++)n.results[r]=t({},n.results[r],n)},l=function(n,t,r,u,f,e,o){if(u||f)return i(this,"GET",e,n,r,null,f);n=s(this,n,t,r);var h=this.TargetEndPoint+(o?"."+o:"")+(n?"/"+n:"");return new BRAVO.Core.Object(this.TargetUrl,h,this.asyncFl)},i=function(n,t,i,u,f,e,o){var h="",c;if(i&&(f.__metadata={type:i}),u&&u.indexOf("_api/")==0)h=u.substr(5);else{var s=n.TargetEndPoint.indexOf("?"),l=s>0?n.TargetEndPoint.substr(s):"",c=s>0?n.TargetEndPoint.substr(0,s):n.TargetEndPoint;h=c+(u?"/"+u:"")+l}return c=n.TargetTemplate.replace("{{EndPoint}}",h).replace("{{Url}}",n.TargetUrl),r(n,c,t,f,e,o)},a=function(n,t,r,u,f,e,h){var c=null,v=null,l,a;return(e=e?e:"POST",(e=="DELETE"||e=="MERGE")&&(c={"IF-MATCH":"*"}),n=s(this,n,t,u?null:r),h&&(this.TargetEndPoint+="."+h),l=function(n,t){if(t=t?JSON.parse(t):t,t.d){if(t.d.__metadata&&t.d.__metadata.uri){var i=o(n,t.d.__metadata.uri);return new BRAVO.Core.Object(i.url,i.endPoint,n.asyncFl,t)}return new BRAVO.Core.Object(n.TargetUrl,n.TargetEndPoint,n.asyncFl,t)}return t},this.asyncFl)?(a=new BRAVO.Core.Promise,i(this,e,f,n,r,c).done(function(n,t){a.resolve(l(n,t))}),a):(v=i(this,e,f,n,r,c),l(this,v))},r=function(n,t,i,r,u,f){var e,s,o;if(t){if(e=y(),i=i?i:"GET",e.open(i=="GET"?"GET":"POST",t,n.asyncFl||f?!0:!1),f)return o=new BRAVO.Core.Promise,e.responseType="arraybuffer",e.onreadystatechange=function(){e.readyState==4&&o.resolve(n,e.response)},e.send(),o;if(e.setRequestHeader("Accept","application/json;odata=verbose"),e.setRequestHeader("Content-Type","application/json;odata=verbose"),e.setRequestHeader("X-HTTP-Method",i),e.setRequestHeader("X-RequestDigest",document.querySelector("#__REQUESTDIGEST").value),u)for(s in u)e.setRequestHeader(s,u[s]);return(r=r?r.byteLength?r:JSON.stringify(r):null,n.asyncFl)?(o=new BRAVO.Core.Promise,e.onreadystatechange=function(){e.readyState==4&&o.resolve(n,e.response)},e.send(r),o):(e.send(r),e.response)}},n=function(){var n=document.location.href;return _spPageContextInfo&&_spPageContextInfo.isAppWeb&&(n=BRAVO.Core.getQueryStringValue("SPHostUrl")+""),n=n.split("/"),n&&n.length>=2&&(n=n[0]+"//"+n[2]),n},v=function(n){var t=document.location.href.split("?"),u,i,r;for(t=t.length>1?t[1]:t[0],u=t.split("&"),i=0;i<u.length;i++)if((r=u[i].split("="),r.length!=1)&&decodeURIComponent(r[0])==n)return decodeURIComponent(r[1]);return null},e=function(n,t,i){var u,f,e,r,o;if(n.results==null||n.results.length==0)return null;for(u=0;u<t.length;u++)if(f=t[u],n.results[0][f]!=null)for(e=0;e<n.results.length;e++)if(r=n.results[e],o=r[f],r.__metadata&&r.__metadata.type=="SP.WebParts.WebPartDefinition"&&(o=r.WebPart[f]),o==i)return r;return null},o=function(n,t){var i="",r=t.split("/_api/SP.AppContextSite(@target)/");return r.length==1&&(r=t.split("/_api/")),r.length==1?(i=r[0].split("/"),i=(n.TargetEndPoint?n.TargetEndPoint+"/":"")+i[i.length-1]):i=r[1],{endPoint:i,url:n.TargetUrl}},y=function(){if(typeof XMLHttpRequest=="undefined"){try{return new ActiveXObject("Msxml2.XMLHTTP.6.0")}catch(n){}try{return new ActiveXObject("Msxml2.XMLHTTP.3.0")}catch(n){}try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(n){}throw new Error("This browser does not support XMLHttpRequest.");}return new XMLHttpRequest},u=function(t,i,r){var u=!1,h=t.asyncFl,e,o,s,f;if(t.asyncFl=!1,t.__metadata.type=="SP.Site")e=null,e=_spPageContextInfo.isAppWeb?n()+t.get_RootWeb().ServerRelativeUrl:_spPageContextInfo.siteAbsoluteUrl,u=new BRAVO.Core.Web(e).hasAccess(i);else if(t.__metadata.type=="SP.Web"&&(r=r||t.get_CurrentUser().LoginName),o=t.getUserEffectivePermissions(r),o.exists)for(u=!0,s=new SP.BasePermissions,s.initPropertiesFromJson(o.GetUserEffectivePermissions),f=0;f<i.length;f++)u&=s.has(i[f]);return t.asyncFl=h,u?!0:!1},p=function(n){if(window._spPageContextInfo){n&&typeof n=="function"&&n();return}window.addEventListener("load",function(){if(window._spPageContextInfo){n&&typeof n=="function"&&n();return}f||(f=!0,["MicrosoftAjax.js","init.js","sp.runtime.js","sp.js","sp.core.js","core.js"].every(function(n){var t=document.createElement("script");t.setAttribute("src","/_layouts/15/"+n);t.setAttribute("type","text/javascript");document.head.appendChild(t)}));var i=0,r=400,t=window.setInterval(function(){window._spPageContextInfo&&(window.clearInterval(t),n&&typeof n=="function"&&n());++i>=r&&window.clearInterval(t)},25)})},w=function(){var n={asyncFl:this.asyncFl,RequestUrl:this.RequestUrl,TargetEndPoint:this.TargetEndPoint,TargetTemplate:this.TargetTemplate,TargetUrl:this.TargetUrl},i;return n.asyncFl?(i=new BRAVO.Core.Promise,r(n,n.RequestUrl).done(function(n,r){n.Response=JSON.parse(r);t(n,n.Response.d);i.resolve(n)}),i):(n.Response=JSON.parse(r(n,n.RequestUrl)),t(n,n.Response.d),n)},b=function(n,t){var r,u,f;if(t!==undefined)return this[n]!=null&&this[n]==t?void 0:(r=this.asyncFl,this.asyncFl=!1,u='{ "'+n+'": '+(typeof t=="string"?'"'+t+'"':t)+" }",f=i(this,"MERGE",this.__metadata.type,null,JSON.parse(u),{"IF-MATCH":"*"}),this.asyncFl=r,f=="")?(this[n]=t,!0):!1},s=function(n,t,i,r){var f,o,e,u;if(t){if(f=t.indexOf("?$filter")>0,i){o=typeof i;t+="(";switch(o){case"boolean":t+=i?"true":"false";break;case"string":t+="'"+(f?encodeURIComponent(i):i)+"'";break;case"object":for(e in i)u=i[e],u=typeof u=="string"?"'"+u+"'":u,t+=e+"="+(f?encodeURIComponent(u):u)+", ";break;default:t+=i}return(t.endsWith(", ")?t.substr(0,t.length-2):t)+")"}r&&(r=typeof r=="string"?"'"+encodeURIComponent(r)+"'":JSON.stringify(r),t+="("+(n.__metadata.type.indexOf("SP.Social.")==0?"item=":"")+"@v)?@v="+r)}return t},t=function(n,t,i){var f,r,u;if(n.exists=t&&t.error==null,t){f=!1;i&&(n.TargetEndPoint=t.__metadata&&t.__metadata.uri?t.__metadata.uri.split("/_api/")[1]:i.targetEndPoint,n.TargetTemplate=i.TargetTemplate,n.TargetUrl=i.TargetUrl);t.results&&n.TargetEndPoint&&n.TargetEndPoint.indexOf("?$filter")&&(n.exists=t.results.length>0,t.results.length==1&&(f=!0,t=t.results[0],u=t.__metadata.uri.split("/_api/"),n.TargetEndPoint=u[1],n.TargetTemplate=n.TargetTemplate.replace(/&@target/,"?@target")));for(r in t){if(t[r]==null){n[r]=t[r];continue}t[r].__deferred&&t[r].__deferred.uri?(u=o(n,t[r].__deferred.uri),n["get_"+r]=new Function('return new BRAVO.Core.Object("'+u.url+'", "'+u.endPoint+'", this.asyncFl);')):n[r]=t[r]}c(n);f&&(n.results=n.results?n.results:[n])}return n};return{getQueryStringValue:v,loadDependencies:p,Object:function(){var n=new function(){},i,u;if(arguments.length>1&&(n.TargetEndPoint=arguments[1],n.TargetUrl=arguments[0],n.TargetTemplate=(_spPageContextInfo.isAppWeb?_spPageContextInfo.webAbsoluteUrl:n.TargetUrl)+"/_api/"+(_spPageContextInfo.isAppWeb?"SP.AppContextSite(@target)/":"")+"{{EndPoint}}"+(_spPageContextInfo.isAppWeb?(n.TargetEndPoint.indexOf("?")>0?"&":"?")+"@target='{{Url}}'":""),n.RequestUrl=n.TargetTemplate.replace("{{EndPoint}}",n.TargetEndPoint).replace("{{Url}}",n.TargetUrl)),n.RequestUrl)if(arguments.length==4&&typeof arguments[3]=="object")n.Response=arguments[3],t(n,n.Response.d);else{if(n.asyncFl=arguments[2]&&typeof arguments[2]=="boolean"?arguments[2]:!1,i=arguments[3]&&typeof(arguments[3]==="string")?arguments[3]:"GET",n.asyncFl)return u=new BRAVO.Core.Promise,r(n,n.RequestUrl,i).done(function(n,i){n.Response=JSON.parse(i);t(n,n.Response.d);u.resolve(n)}),u;n.Response=JSON.parse(r(n,n.RequestUrl,i));t(n,n.Response.d)}return n},Promise:function(){return{_arguments:null,_callback:null,_resolveFl:!1,done:function(n){this._callback=n;this._callback&&this._resolveFl&&this._callback.apply(this,this._arguments)},resolve:function(){this._arguments=arguments;this._resolveFl=!0;this._callback&&this._callback.apply(this,this._arguments)}}},List:function(t,i,r){return t=encodeURIComponent(t),i?new BRAVO.Core.Object(i.indexOf("http")==0?i:n()+i,"web/lists?$filter=Title eq '"+t+"'",r):window._spPageContextInfo?new BRAVO.Core.Object(window._spPageContextInfo.webAbsoluteUrl,"web/lists?$filter=Title eq '"+t+"'",r):null},ListAsync:function(n,t){return new BRAVO.Core.List(n,t,!0)},PeopleManager:function(t,i){return t?new BRAVO.Core.Object(t.indexOf("http")==0?t:n()+t,"sp.userprofiles.peoplemanager",i):window._spPageContextInfo?new BRAVO.Core.Object(window._spPageContextInfo.siteAbsoluteUrl,"sp.userprofiles.peoplemanager",i):null},PeopleManagerAsync:function(n){return new BRAVO.Core.PeopleManager(n,!0)},ProfileLoader:function(t,i){return t?new BRAVO.Core.Object(t.indexOf("http")==0?t:n()+t,"sp.userprofiles.profileloader.getprofileloader",i,"POST"):window._spPageContextInfo?new BRAVO.Core.Object(window._spPageContextInfo.siteAbsoluteUrl,"sp.userprofiles.profileloader.getprofileloader",i,"POST"):null},ProfileLoaderAsync:function(n){return new BRAVO.Core.ProfileLoader(n,!0)},Search:function(t,i){return t?new BRAVO.Core.Object(t.indexOf("http")==0?t:n()+t,"search",i):window._spPageContextInfo?new BRAVO.Core.Object(window._spPageContextInfo.siteAbsoluteUrl,"search",i):null},SearchAsync:function(n){return new BRAVO.Core.Search(n,!0)},SocialManager:function(t,i){return t?new BRAVO.Core.Object(t.indexOf("http")==0?t:n()+t,"social.feed",i):window._spPageContextInfo?new BRAVO.Core.Object(window._spPageContextInfo.siteAbsoluteUrl,"social.feed",i):null},SocialManagerAsync:function(n){return new BRAVO.Core.SocialManager(n,!0)},Site:function(t,i){return t?new BRAVO.Core.Object(t.indexOf("http")==0?t:n()+t,"site",i):window._spPageContextInfo?new BRAVO.Core.Object(window._spPageContextInfo.siteAbsoluteUrl,"site",i):null},SiteAsync:function(n){return new BRAVO.Core.Site(n,!0)},Utility:{createEmailBodyForInvitation:function(){"POST"},getCurrentUserEmailAddresses:function(){return new BRAVO.Core.Object(window._spPageContextInfo.siteAbsoluteUrl,"sp.utilities.utility.getCurrentUserEmailAddresses")}},Web:function(t,i){return t?new BRAVO.Core.Object(t.indexOf("http")==0?t:n()+t,"web",i):window._spPageContextInfo?new BRAVO.Core.Object(window._spPageContextInfo.webAbsoluteUrl,"web",i):null},WebAsync:function(n){return new BRAVO.Core.Web(n,!0)}}}();BRAVO.Core.loadDependencies(function(){SP.SOD.notifyScriptLoadedAndExecuteWaitingJobs("bravo.js")});BRAVO.JSLink=function(){function e(){if(r!=null)return r;var n=f();return n.exists&&(r=n.get_CurrentUser()),r}var s=null,y=function(n){return s!=null?s:n&&n.CurrentFieldSchema?n.CurrentFieldSchema:null},t=null,p=function(n){var i,r;return t!=null?t:(i=n.FormContext?n.FormContext.itemAttributes.Id:BRAVO.Core.getQueryStringValue("ID"),i&&(r=h(n),r.exists&&(t=r.getItemById(i))),t)},i=null,h=function(n){var t,r,u;return i!=null?i:(t=f(),t.exists&&(r=n&&n.FormContext?n.FormContext.listAttributes.Id:null,u=n&&n.ListTitle?n.ListTitle:n.ListName,i=r?t.getListById(r):t.getListByTitle(u)),i)},r=null,u=null,f=function(){return u!=null?u:u=new BRAVO.Core.Web},o={Attachments:{View:window.RenderFieldValueDefault,DisplayForm:window.SPFieldAttachments_Default,EditForm:window.SPFieldAttachments_Default,NewForm:window.SPFieldAttachments_Default},Boolean:{View:window.RenderFieldValueDefault,DisplayForm:window.SPField_FormDisplay_DefaultNoEncode,EditForm:window.SPFieldBoolean_Edit,NewForm:window.SPFieldBoolean_Edit},Currency:{View:window.RenderFieldValueDefault,DisplayForm:window.SPField_FormDisplay_Default,EditForm:window.SPFieldNumber_Edit,NewForm:window.SPFieldNumber_Edit},Calculated:{View:window.RenderFieldValueDefault,DisplayForm:window.SPField_FormDisplay_Default,EditForm:window.SPField_FormDisplay_Empty,NewForm:window.SPField_FormDisplay_Empty},Choice:{View:window.RenderFieldValueDefault,DisplayForm:window.SPField_FormDisplay_Default,EditForm:window.SPFieldChoice_Edit,NewForm:window.SPFieldChoice_Edit},Computed:{View:window.RenderFieldValueDefault,DisplayForm:window.SPField_FormDisplay_Default,EditForm:window.SPField_FormDisplay_Default,NewForm:window.SPField_FormDisplay_Default},DateTime:{View:window.RenderFieldValueDefault,DisplayForm:window.SPFieldDateTime_Display,EditForm:window.SPFieldDateTime_Edit,NewForm:window.SPFieldDateTime_Edit},File:{View:window.RenderFieldValueDefault,DisplayForm:window.SPFieldFile_Display,EditForm:window.SPFieldFile_Edit,NewForm:window.SPFieldFile_Edit},Integer:{View:window.RenderFieldValueDefault,DisplayForm:window.SPField_FormDisplay_Default,EditForm:window.SPFieldNumber_Edit,NewForm:window.SPFieldNumber_Edit},Lookup:{View:window.RenderFieldValueDefault,DisplayForm:window.SPFieldLookup_Display,EditForm:window.SPFieldLookup_Edit,NewForm:window.SPFieldLookup_Edit},LookupMulti:{View:window.RenderFieldValueDefault,DisplayForm:window.SPFieldLookup_Display,EditForm:window.SPFieldLookup_Edit,NewForm:window.SPFieldLookup_Edit},MultiChoice:{View:window.RenderFieldValueDefault,DisplayForm:window.SPField_FormDisplay_Default,EditForm:window.SPFieldMultiChoice_Edit,NewForm:window.SPFieldMultiChoice_Edit},Note:{View:window.RenderFieldValueDefault,DisplayForm:window.SPFieldNote_Display,EditForm:window.SPFieldNote_Edit,NewForm:window.SPFieldNote_Edit},Number:{View:window.RenderFieldValueDefault,DisplayForm:window.SPField_FormDisplay_Default,EditForm:window.SPFieldNumber_Edit,NewForm:window.SPFieldNumber_Edit},Text:{View:window.RenderFieldValueDefault,DisplayForm:window.SPField_FormDisplay_Default,EditForm:window.SPFieldText_Edit,NewForm:window.SPFieldText_Edit},URL:{View:window.RenderFieldValueDefault,DisplayForm:window.SPFieldUrl_Display,EditForm:window.SPFieldUrl_Edit,NewForm:window.SPFieldUrl_Edit},User:{View:window.RenderFieldValueDefault,DisplayForm:window.SPFieldUser_Display,EditForm:window.SPClientPeoplePickerCSRTemplate,NewForm:window.SPClientPeoplePickerCSRTemplate},UserMulti:{View:window.RenderFieldValueDefault,DisplayForm:window.SPFieldUserMulti_Display,EditForm:window.SPClientPeoplePickerCSRTemplate,NewForm:window.SPClientPeoplePickerCSRTemplate}},w=function(t){var f=["input","select"],r=document.createElement("div"),i,u;for(r.innerHTML=n(t),i=0;i<f.length;i++)if(u=r.querySelector(f[i]),u){u.setAttribute("data-field-name",t.CurrentFieldSchema.Name);break}return r.innerHTML},b=function(n,t){var f,i,r,u;if(n!=null&&t!=null){if(f=SPClientTemplates.Utility.GetFormContextForCurrentField(n),i=new SPClientForms.ClientValidation.ValidatorSet,typeof t=="object"&&t.length)for(r=0;r<t.length;r++)i.RegisterValidator(new c(t[r]));else u=function(){},u.prototype.Validate=t,i.RegisterValidator(new u);f.registerClientValidator(n.CurrentFieldSchema.Name,i)}},k=function(t){var i=e();return i.exists?a(t,i):n(t)},d=function(t,i){var u,f,r;if(t.CurrentFieldValue){u="";switch(t.CurrentFieldSchema.Type){case"MultiChoice":f=new RegExp(SPClientTemplates.Utility.UserLookupDelimitString,"g");u=t.CurrentFieldValue.replace(f,"; ").replace(/^; /g,"").replace(/; $/g,"");break;case"Note":u="<div>"+t.CurrentFieldValue.replace(/\n/g,"<br />")+"<\/div>";break;case"User":case"UserMulti":for(r=0;r<t.CurrentFieldValue.length;r++)u+=t.CurrentFieldValue[r].EntityData.SPUserID+SPClientTemplates.Utility.UserLookupDelimitString+t.CurrentFieldValue[r].DisplayText+(r==t.CurrentFieldValue.length-1?"":SPClientTemplates.Utility.UserLookupDelimitString)}t.CurrentFieldValue=u}return n(t,i,"DisplayForm")},g=function(t,i){return t.inGridMode?(i.AllowGridEditing=!1,""):n(t,i)},c=function(n){c.prototype.Validate=n},n=function(n,t,i){var u=t?t.Type:n.CurrentFieldSchema?n.CurrentFieldSchema.Type:null,f,t,r;if(i=i?i:null,i==null)switch(n.ControlMode){case SPClientTemplates.ClientControlMode.DisplayForm:i="DisplayForm";break;case SPClientTemplates.ClientControlMode.EditForm:i="EditForm";break;case SPClientTemplates.ClientControlMode.NewForm:i="NewForm";break;case SPClientTemplates.ClientControlMode.View:i="View"}if(o[u]&&o[u][i]&&(f=o[u][i](n),f))return f;t=n.CurrentFieldSchema;r=null;switch(t.Type){case"AllDayEvent":r=new AllDayEventFieldRenderer(t.Name);break;case"Attachments":r=new AttachmentFieldRenderer(t.Name);break;case"BusinessData":r=new BusinessDataFieldRenderer(t.Name);break;case"Computed":r=new ComputedFieldRenderer(t.Name);break;case"CrossProjectLink":r=new ProjectLinkFieldRenderer(t.Name);break;case"Currency":r=new NumberFieldRenderer(t.Name);break;case"DateTime":r=new DateTimeFieldRenderer(t.Name);break;case"Lookup":r=new LookupFieldRenderer(t.Name);break;case"LookupMulti":r=new LookupFieldRenderer(t.Name);break;case"Note":r=new NoteFieldRenderer(t.Name);break;case"Number":r=new NumberFieldRenderer(t.Name);break;case"Recurrence":r=new RecurrenceFieldRenderer(t.Name);break;case"Text":r=new TextFieldRenderer(t.Name);break;case"URL":r=new UrlFieldRenderer(t.Name);break;case"User":r=new UserFieldRenderer(t.Name);break;case"UserMulti":r=new UserFieldRenderer(t.Name);break;case"WorkflowStatus":r=new RawFieldRenderer(t.Name)}return r?r.RenderField(n,t,n.CurrentItem,n.ListSchema):n.CurrentItem[t.Name]},l=function(t,i){t.CurrentFieldValue=[];for(var r=0;r<i.length;r++)t.CurrentFieldValue.push({Description:i[r].LoginName,DisplayText:i[r].Title,EntityGroupName:"",EntityType:"",HierarchyIdentifier:null,IsResolved:!0,Key:i[r].LoginName,MultipleMatches:[],ProviderDisplayName:"",ProviderName:""});return n(t)},a=function(n,t){return l(n,[t])},v=function(n){return document.querySelector("#WebPart"+(n.FormUniqueId||n.wpq)+" .ms-formtable")},nt=function(n){return n.ListData?n.ListData.Row:[]},tt=function(){return SP.ListOperation.Selection.getSelectedItems()},it=function(n){var t=v(n);return t&&t.getAttribute("data-hide-row-event")==null&&(window.addEventListener("load",function(){for(var n,i=document.querySelectorAll(".hide-row"),t=0;t<i.length;t++){for(n=i[t];n&&n.nodeName.toLowerCase()!="tr";)n=n.parentNode;n&&(n.style.display="none")}}),t.setAttribute("data-hide-row-event",!0)),"<div class='hide-row' />"},rt=function(){var n=document.forms[MSOWebPartPageFormName];return n&&(n.MSOLayout_InDesignMode&&n.MSOLayout_InDesignMode.value=="1"||n._wikiPageMode&&n._wikiPageMode.value=="Edit")?!0:!1},ut=function(n,t,i,r){var u=f();u&&(i=typeof i=="string"?[i]:i,u.sendEmail({To:{results:i},From:r?r:e().Email,Subject:n,Body:t}))};return{addFieldNameAttribute:w,addValidation:b,defaultToCurrentUser:k,disableEdit:d,disableQuickEdit:g,getCurrentField:y,getCurrentItem:p,getCurrentList:h,getCurrentUser:e,getCurrentWeb:f,getFieldDefaultHtml:n,getFieldMultiUserHtml:l,getFieldUserHtml:a,getListView:v,getViewListItems:nt,getViewSelectedItems:tt,hideField:it,inEditMode:rt,sendEmail:ut}}();BRAVO.Core.loadDependencies(function(){SP.SOD.notifyScriptLoadedAndExecuteWaitingJobs("bravo.jslink.js")});BRAVO.ModalDialog=function(){var t=function(n,t){n!=null&&typeof n=="number"?SP.UI.ModalDialog.commonModalDialogClose(n,t):SP.UI.ModalDialog.commonModalDialogClose(SP.UI.DialogResult.cancel,t)},i=function(){return window.frameElement?window.frameElement.dialogArgs:null},r=function(){return SP.UI.ModalDialog.get_childDialog()!=null},n=function(n,t,i,r,u){if(arguments.length!=0){var f={args:r?r:null,dialogReturnValueCallback:u?u:null,showMaximized:i?!0:!1,title:n};return typeof t=="string"?f.url=t:f.html=t,SP.UI.ModalDialog.showModalDialog(f)}},u=function(t,i,r,u,f){var e=document.createElement("div");e.innerHTML=i;n(t,e,r,u,f)},f=function(n,t){n==SP.UI.DialogResult.OK&&(t&&typeof t=="string"&&(t.toLowerCase().indexOf("http")==0||t.indexOf("/")==0)&&(document.location.href=t),document.location.reload())},e=function(n,t,i,r){arguments.length!=0&&(i&&r?SP.UI.ModalDialog.showWaitScreenWithNoClose(n,t,i,r):SP.UI.ModalDialog.showWaitScreenWithNoClose(n,t))},o=function(n,t){var i={title:null,message:null},f=document.querySelector(".ms-dlgContent"),r,u;return f&&(r=f.querySelector(".ms-core-pageTitle"),r&&(i.title=r.innerHTML,r.innerHTML=n!=null?n:i.title),u=f.querySelector(".ms-textXLarge"),u&&(i.message=u.innerHTML,u.innerHTML=t!=null?t:i.message),SP.UI.ModalDialog.get_childDialog().autoSize()),i};return{close:t,getArguments:i,isDialog:r,open:n,openHtml:u,refreshOnSuccess:f,showWaitScreen:e,updateWaitScreen:o}}();BRAVO.Core.loadDependencies(function(){SP.SOD.executeFunc("sp.ui.dialog.js","SP.UI.ModalDialog",function(){SP.SOD.notifyScriptLoadedAndExecuteWaitingJobs("bravo.modaldialog.js")})});